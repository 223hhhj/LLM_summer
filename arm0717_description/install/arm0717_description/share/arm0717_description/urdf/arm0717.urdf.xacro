<?xml version="1.0" encoding="utf-8"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="arm0717">

  <!-- 參數定義 -->
  <xacro:arg name="prefix" default="" />
  <xacro:property name="prefix" value="$(arg prefix)" />

  <!-- 材質定義 -->
  <material name="${prefix}default_material">
    <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
  </material>

  <!-- ARM0717 機器人 macro 定義 -->
  <xacro:macro name="arm0717_robot" params="prefix:=''">
    
    <!-- Base Link -->
    <link name="${prefix}base_link">
      <inertial>
        <origin xyz="0.0123059234223451 -0.100304574267466 1.7006088289757E-17" rpy="0 0 0" />
        <mass value="8.42454047875456" />
        <inertia ixx="0.0538535223566871" ixy="1.34806067324256E-18" ixz="3.94153228574131E-19"
                 iyy="0.0474155131881787" iyz="9.22661053587575E-19" izz="0.0522226317316871" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/base_link.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/base_link.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Link 1 (保留 arm0717 原參數) -->
    <link name="${prefix}link1">
      <inertial>
        <origin xyz="4.38321153960351E-10 -0.0197289552878621 0.100874218917433" rpy="0 0 0" />
        <mass value="8.85588047875456" />
        <inertia ixx="0.0537141683691871" ixy="-2.59674279673715E-11" ixz="8.55092890238989E-19"
                 iyy="0.0548829694116871" iyz="-1.14222586402274E-18" izz="0.0475552125206787" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link1.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link1.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 1 (保留 arm0717 原參數) -->
    <joint name="${prefix}joint1" type="revolute">
      <origin xyz="0 0 0" rpy="0 0 0" />
      <parent link="${prefix}base_link" />
      <child link="${prefix}link1" />
      <axis xyz="0 0 1" />
      <limit lower="-3.14159" upper="3.14159" effort="100" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- Link 2 (使用 arm0717 的 link_2 參數) -->
    <link name="${prefix}link2">
      <inertial>
        <origin xyz="0.0873279857714775 0.0399699522178334 -0.0065808069605363" rpy="0 0 0" />
        <mass value="5.65179598675955" />
        <inertia ixx="0.0334123150568175" ixy="-0.00929268144862595" ixz="0.00152998288378939"
                 iyy="0.031712702102003" iyz="0.000870235823860031" izz="0.0368549883284273" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link2.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link2.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 2 (使用 arm0717 的 joint2 參數，修正 limit) -->
    <joint name="${prefix}joint2" type="revolute">
      <origin xyz="0.003161 -0.203 -0.00052044" rpy="3.1416 0 -1.5708" />
      <parent link="${prefix}link1" />
      <child link="${prefix}link2" />
      <axis xyz="-1 0 0" />
      <limit lower="-3.14159" upper="3.14159" effort="100" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- Link 3 (使用 arm0717 的 link_3 參數) -->
    <link name="${prefix}link3">
      <inertial>
        <origin xyz="0.0269856699858579 0.108613986777404 -0.0131700166645286" rpy="0 0 0" />
        <mass value="1.81899821933697" />
        <inertia ixx="0.0208920270655717" ixy="-6.46843395750531E-05" ixz="7.84331609043551E-06"
                 iyy="0.00253245042725667" iyz="0.0020303771980531" izz="0.0190309097570163" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link3.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link3.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 3 (使用 arm0717 的 joint3 參數，修正 limit) -->
    <joint name="${prefix}joint3" type="revolute">
      <origin xyz="0.12791 0.08589 0.067949" rpy="3.1416 -1.4076 1.5708" />
      <parent link="${prefix}link2" />
      <child link="${prefix}link3" />
      <axis xyz="-1 0 0" />
      <limit lower="-3.14159" upper="3.14159" effort="100" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- Link 4 (使用 arm0717 的 link_4 參數) -->
    <link name="${prefix}link4">
      <inertial>
        <origin xyz="0 0.0505156155126493 0.01237701303467" rpy="0 0 0" />
        <mass value="3.82808754456696" />
        <inertia ixx="0.0201780834303075" ixy="1.02054395401905E-18" ixz="-1.30104260698261E-18"
                 iyy="0.0126480096719491" iyz="-0.00224732475144833" izz="0.018457351525643" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link4.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link4.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 4 (使用 arm0717 的 joint4 參數，修正 limit) -->
    <joint name="${prefix}joint4" type="revolute">
      <origin xyz="-0.074 0.24523 -0.029735" rpy="0 0 0" />
      <parent link="${prefix}link3" />
      <child link="${prefix}link4" />
      <axis xyz="-1 0 0" />
      <limit lower="-3.14159" upper="3.14159" effort="50" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- Link 5 (使用 arm0717 的 link_5 參數) -->
    <link name="${prefix}link5">
      <inertial>
        <origin xyz="0.0743030110589211 -1.11022302462516E-16 1.04083408558608E-17" rpy="0 0 0" />
        <mass value="1.37952769169633" />
        <inertia ixx="0.00264530874714722" ixy="-4.02340649945793E-19" ixz="4.87890977618477E-19"
                 iyy="0.00480500973038069" iyz="-0.000256690753608414" izz="0.00496542431383725" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link5.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link5.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 5 (使用 arm0717 的 joint5 參數，修正 limit) -->
    <joint name="${prefix}joint5" type="revolute">
      <origin xyz="0 0.077794 0.1037" rpy="1.5708 -1.3334 -1.5708" />
      <parent link="${prefix}link4" />
      <child link="${prefix}link5" />
      <axis xyz="-1 0 0" />
      <limit lower="-3.14159" upper="3.14159" effort="50" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- Link 6 (使用 arm0717 的 link_6 參數) -->
    <link name="${prefix}link6">
      <inertial>
        <origin xyz="0 -0.010763768412671 0.00562866264335971" rpy="0 0 0" />
        <mass value="0.515366765623615" />
        <inertia ixx="0.00071236571122841" ixy="-2.71050543121376E-20" ixz="-5.42101086242752E-20"
                 iyy="0.00056392241031998" iyz="5.80452413969748E-05" izz="0.000644569707282097" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link6.STL" />
        </geometry>
        <material name="${prefix}default_material" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <mesh filename="package://arm0717_description/meshes/arm0717/link6.STL" />
        </geometry>
      </collision>
    </link>

    <!-- Joint 6 (使用 arm0717 的 joint6 參數，修正 limit) -->
    <joint name="${prefix}joint6" type="revolute">
      <origin xyz="0.185 0 0" rpy="-1.9586 0.63397 -1.5708" />
      <parent link="${prefix}link5" />
      <child link="${prefix}link6" />
      <axis xyz="-1 0 0" />
      <limit lower="-3.14159" upper="3.14159" effort="25" velocity="1.0" />
      <dynamics damping="0.1" friction="0.1" />
    </joint>

    <!-- 末端執行器 (保留 arm0717 原參數) -->
    <link name="${prefix}end_effector">
      <inertial>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <mass value="0.1" />
        <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <geometry>
          <box size="0.05 0.05 0.05" />
        </geometry>
        <material name="${prefix}end_effector_material">
          <color rgba="1.0 0.0 0.0 0.8" />
        </material>
      </visual>
      <collision>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <geometry>
          <box size="0.05 0.05 0.05" />
        </geometry>
      </collision>
    </link>
    
    <!-- 末端執行器關節 (保留 arm0717 原參數) -->
    <joint name="${prefix}end_effector_joint" type="fixed">
      <origin xyz="0 0 0.05" rpy="0 0 0" />
      <parent link="${prefix}link6" />
      <child link="${prefix}end_effector" />
    </joint>

    <!-- 添加 tool_frame（工具座標系，保留 arm0717 原參數） -->
    <link name="${prefix}tool_frame">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <mass value="0.001" />
        <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001" />
      </inertial>
    </link>
    
    <joint name="${prefix}tool_joint" type="fixed">
      <origin xyz="0 0 0.1" rpy="0 0 0" />
      <parent link="${prefix}link6" />
      <child link="${prefix}tool_frame" />
    </joint>

  </xacro:macro>

  <!-- 如果直接啟動此檔案，使用預設無 prefix -->
  <xacro:arm0717_robot prefix="${prefix}" />

</robot>